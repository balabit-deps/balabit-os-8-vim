From: Markus Koschany <apo@debian.org>
Date: Wed, 9 Mar 2022 22:19:41 +0100
Subject: CVE-2022-0359

Origin: https://github.com/vim/vim/commit/85b6747abc15a7a81086db31289cf1b8b17e6cb1
---
 src/ex_getln.c           |  2 +-
 src/testdir/test_CVE.vim | 10 ++++++++++
 2 files changed, 11 insertions(+), 1 deletion(-)

--- vim-8.1.2269.orig/src/ex_getln.c
+++ vim-8.1.2269/src/ex_getln.c
@@ -852,7 +852,7 @@ getcmdline_int(
     ccline.cmdindent = (firstc > 0 ? indent : 0);
 
     /* alloc initial ccline.cmdbuff */
-    alloc_cmdbuff(exmode_active ? 250 : indent + 1);
+    alloc_cmdbuff(indent + 50);
     if (ccline.cmdbuff == NULL)
 	goto theend;	// out of memory
     ccline.cmdlen = ccline.cmdpos = 0;
