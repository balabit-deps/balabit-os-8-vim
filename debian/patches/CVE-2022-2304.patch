From 54e5fed6d27b747ff152cdb6edfb72ff60e70939 Mon Sep 17 00:00:00 2001
From: Bram Moolenaar <Bram@vim.org>
Date: Mon, 4 Jul 2022 13:37:07 +0100
Subject: [PATCH] patch 9.0.0035: spell dump may go beyond end of an array

Problem:    Spell dump may go beyond end of an array.
Solution:   Limit the word length.

--- vim-8.1.2269.orig/src/spell.c
+++ vim-8.1.2269/src/spell.c
@@ -3955,9 +3955,10 @@ spell_dump_compl(
 		    n = arridx[depth] + curi[depth];
 		    ++curi[depth];
 		    c = byts[n];
-		    if (c == 0)
+		    if (c == 0 || depth >= MAXWLEN - 1)
 		    {
-			/* End of word, deal with the word.
+			/* End of word or reached maximum length, deal with the
+			 * word.
 			 * Don't use keep-case words in the fold-case tree,
 			 * they will appear in the keep-case tree.
 			 * Only use the word when the region matches. */
