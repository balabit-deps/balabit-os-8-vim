From 35d21c6830fc2d68aca838424a0e786821c5891c Mon Sep 17 00:00:00 2001
From: Bram Moolenaar <Bram@vim.org>
Date: Fri, 2 Sep 2022 16:47:16 +0100
Subject: [PATCH] patch 9.0.0360: crash when invalid line number on :for is
 ignored

Problem:    Crash when invalid line number on :for is ignored.
Solution:   Do not check breakpoint for non-existing line.
---
 src/ex_docmd.c                  |  2 +-
 src/testdir/test_eval_stuff.vim | 13 +++++++++++++
 src/version.c                   |  2 ++
 3 files changed, 16 insertions(+), 1 deletion(-)

--- vim-8.1.2269.orig/src/ex_docmd.c
+++ vim-8.1.2269/src/ex_docmd.c
@@ -1050,7 +1050,7 @@ do_cmdline(
 
 		    /* Check for the next breakpoint at or after the ":while"
 		     * or ":for". */
-		    if (breakpoint != NULL)
+		    if (breakpoint != NULL && lines_ga.ga_len > current_line)
 		    {
 			*breakpoint = dbg_find_breakpoint(
 			       getline_equal(fgetline, cookie, getsourceline),
