From 8f3c3c6cd044e3b5bf08dbfa3b3f04bb3f711bad Mon Sep 17 00:00:00 2001
From: Bram Moolenaar <Bram@vim.org>
Date: Tue, 18 Oct 2022 17:05:54 +0100
Subject: [PATCH] patch 9.0.0789: dummy buffer ends up in a window

Problem:    Dummy buffer ends up in a window.
Solution:   Disallow navigating to a dummy buffer.
---
 src/buffer.c                 |  7 +++++++
 src/testdir/test_autocmd.vim | 20 ++++++++++++++++++++
 src/version.c                |  2 ++
 3 files changed, 29 insertions(+)

--- vim-8.1.2269.orig/src/buffer.c
+++ vim-8.1.2269/src/buffer.c
@@ -1400,6 +1400,13 @@ do_buffer(
 #ifdef FEAT_GUI
     need_mouse_correct = TRUE;
 #endif
+    if ((action == DOBUF_GOTO || action == DOBUF_SPLIT)
+						  && (buf->b_flags & BF_DUMMY))
+    {
+	// disallow navigating to the dummy buffer
+	semsg(_("E86: Buffer %ld does not exist"), count);
+	return FAIL;
+    }
 
     /*
      * delete buffer buf from memory and/or the list
