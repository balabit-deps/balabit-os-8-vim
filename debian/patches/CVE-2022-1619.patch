From ef02f16609ff0a26ffc6e20263523424980898fe Mon Sep 17 00:00:00 2001
From: Bram Moolenaar <Bram@vim.org>
Date: Sat, 7 May 2022 10:49:10 +0100
Subject: [PATCH] patch 8.2.4899: with latin1 encoding CTRL-W might go before
 the cmdline

Problem:    With latin1 encoding CTRL-W might go before the start of the
            command line.
Solution:   Check already being at the start of the command line.
---
 src/ex_getln.c               | 11 +++++++----
 src/testdir/test_cmdline.vim |  3 +++
 src/version.c                |  2 ++
 3 files changed, 12 insertions(+), 4 deletions(-)

--- vim-8.1.2269.orig/src/ex_getln.c
+++ vim-8.1.2269/src/ex_getln.c
@@ -1575,10 +1575,13 @@ getcmdline_int(
 		    {
 			while (p > ccline.cmdbuff && vim_isspace(p[-1]))
 			    --p;
-			i = vim_iswordc(p[-1]);
-			while (p > ccline.cmdbuff && !vim_isspace(p[-1])
-				&& vim_iswordc(p[-1]) == i)
-			    --p;
+			if (p > ccline.cmdbuff)
+			{
+			    i = vim_iswordc(p[-1]);
+			    while (p > ccline.cmdbuff && !vim_isspace(p[-1])
+				    && vim_iswordc(p[-1]) == i)
+				--p;
+			}
 		    }
 		    else
 			--p;
